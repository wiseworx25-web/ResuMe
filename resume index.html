<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Build a job-winning online resume. Publish for $2.99.">
  <title>ResuMe â€” Your Story, Your Way</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600&family=Merriweather:wght@400;600&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style id="template-styles">
    :root {
      --primary: #0066cc;
      --accent: #00cc99;
      --bg: #fafcff;
      --card-bg: white;
      --font-main: 'IBM Plex Sans', sans-serif;
      --font-heading: 'Merriweather', serif;
    }
  </style>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--bg);
      color: #1a202c;
      line-height: 1.6;
      padding: 1.5rem;
      font-family: var(--font-main);
    }
    .container { max-width: 1200px; margin: 0 auto; }
    header { text-align: center; margin-bottom: 2rem; }
    header h1 {
      font-size: 2.4rem;
      color: var(--primary);
      margin-bottom: 0.4rem;
      font-family: var(--font-heading);
    }
    header h1 span { color: var(--accent); }
    .form-section, .preview-pane, .output-section {
      background: var(--card-bg);
      padding: 1.8rem;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.06);
      margin-bottom: 1.8rem;
    }
    h2 {
      color: var(--primary);
      margin-bottom: 1.2rem;
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: var(--font-heading);
    }
    input, textarea, select {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #e6eaf0;
      border-radius: 10px;
      font-family: var(--font-main);
    }
    button {
      background: var(--primary);
      color: white;
      padding: 0.75rem 1.6rem;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,102,204,0.25);
    }
    .template-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    .template-card {
      border: 2px solid #e6eaf0;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      cursor: pointer;
      font-weight: 500;
    }
    .template-card.active {
      border-color: var(--accent);
      background: rgba(0,204,153,0.05);
    }
    .experience-item, .cert-item, .showcase-item, .vault-item {
      background: #f8fafc;
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 0.8rem;
      position: relative;
    }
    .remove-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: none;
      border: none;
      color: #e53e3e;
      cursor: pointer;
      font-weight: bold;
    }
    .suggestion {
      background: #f0fdf4;
      border-left: 3px solid var(--accent);
      padding: 0.8rem;
      margin: 0.8rem 0;
      font-size: 0.9rem;
      color: #065f46;
    }
    .preview-pane { min-height: 600px; }
    .output-section { display: none; }
    .qr-code {
      max-width: 200px;
      margin: 0 auto;
      border: 2px solid #e6eaf0;
      border-radius: 12px;
      padding: 1rem;
      background: white;
    }
    @media (max-width: 768px) {
      body { padding: 1rem; }
      header h1 { font-size: 1.8rem; }
    }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1><span>Resu</span>Me</h1>
      <p>Build a job-winning resume. Publish for just <strong>$2.99</strong>.</p>
    </header>

    <!-- Template Selector -->
    <div class="form-section">
      <h2><i class="fas fa-palette"></i> Choose Your Style</h2>
      <div class="template-grid">
        <div class="template-card active" data-template="executive">Executive</div>
        <div class="template-card" data-template="tech">Tech Pro</div>
        <div class="template-card" data-template="creative">Creative</div>
        <div class="template-card" data-template="consultant">Consultant</div>
        <div class="template-card" data-template="hybrid">Hybrid</div>
      </div>
    </div>

    <!-- Profile -->
    <div class="form-section">
      <h2><i class="fas fa-user"></i> Name & Title</h2>
      <input type="text" id="name" placeholder="Full Name" required>
      <input type="text" id="title" placeholder="Professional Title" required>
    </div>

    <!-- Summary -->
    <div class="form-section">
      <h2><i class="fas fa-comment-alt"></i> Professional Summary</h2>
      <textarea id="summary" placeholder="3â€“5 sentences about your impact..." rows="6" required></textarea>
    </div>

    <!-- Skills -->
    <div class="form-section">
      <h2><i class="fas fa-star"></i> Key Skills</h2>
      <textarea id="skills" placeholder="e.g., GenAI, Watsonx, TOGAF..." rows="6" required></textarea>
    </div>

    <!-- Experience -->
    <div class="form-section">
      <h2><i class="fas fa-briefcase"></i> Professional Experience</h2>
      <div id="experience-list"></div>
      <button type="button" onclick="addExperience()"><i class="fas fa-plus"></i> Add Role</button>
    </div>

    <!-- Education -->
    <div class="form-section">
      <h2><i class="fas fa-graduation-cap"></i> Education</h2>
      <div id="education-list"></div>
      <button type="button" onclick="addEducation()"><i class="fas fa-plus"></i> Add Degree</button>
    </div>

    <!-- Certifications -->
    <div class="form-section">
      <h2><i class="fas fa-certificate"></i> Certifications</h2>
      <div id="certs-list"></div>
      <button type="button" onclick="addCert()"><i class="fas fa-plus"></i> Add Certification</button>
    </div>

    <!-- Showcase -->
    <div class="form-section">
      <h2><i class="fas fa-images"></i> Showcase / Projects</h2>
      <p>Add key projects with title + description.</p>
      <div id="showcase-list"></div>
      <button type="button" onclick="addShowcaseItem()"><i class="fas fa-plus"></i> Add Project</button>
    </div>

    <!-- Private Vault -->
    <div class="form-section">
      <h2><i class="fas fa-lock"></i> Private Vault (Optional)</h2>
      <p>Add sensitive info (ID, address, etc.). Only visible to guests with your password.</p>
      <input type="password" id="vault-password" placeholder="Set a guest password (e.g., ibm2024)" autocomplete="off">
      <textarea id="vault-content" placeholder="Enter confidential details (e.g., ID: 901203..., Marital Status: Single...)" rows="4"></textarea>
      <div class="suggestion">
        ðŸ’¡ <em>Share this password only with trusted recruiters.</em>
      </div>
    </div>

    <!-- Contact -->
    <div class="form-section">
      <h2><i class="fas fa-paper-plane"></i> Contact</h2>
      <input type="email" id="email" placeholder="Email (required)" required>
      <input type="url" id="linkedin" placeholder="LinkedIn URL">
      <input type="text" id="phone" placeholder="Phone (optional)">
    </div>

    <!-- Preview -->
    <div class="form-section">
      <h2><i class="fas fa-eye"></i> Live Preview</h2>
      <div class="preview-pane" id="preview">
        <p style="text-align:center; color:#94a3b8;">Your ResuMe will appear here...</p>
      </div>
    </div>

    <!-- Publish -->
    <button onclick="initiatePayment()"><i class="fas fa-lock"></i> Secure Publish â€” $2.99</button>

    <div class="output-section" id="output">
      <h2><i class="fas fa-check-circle"></i> Published!</h2>
      <p>Your personal link: <span id="live-url" style="color:var(--primary); font-weight:600;"></span></p>
      <div class="qr-code" id="qr-code"></div>
      <p style="text-align:center; margin-top:1rem;">Scan to view instantly on any device</p>
    </div>
  </div>

  <script src="https://js.stripe.com/v3/"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <script>
    // ===== VAULT ENCRYPTION =====
    async function encryptVault(text, password) {
      if (!text || !password) return null;
      const encoder = new TextEncoder();
      const data = encoder.encode(text);
      const pwHash = await crypto.subtle.digest('SHA-256', encoder.encode(password));
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const alg = { name: 'AES-GCM', iv: iv };
      const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['encrypt']);
      const encrypted = await crypto.subtle.encrypt(alg, key, data);
      const buffer = new Uint8Array(iv.byteLength + encrypted.byteLength);
      buffer.set(iv, 0);
      buffer.set(new Uint8Array(encrypted), iv.byteLength);
      return btoa(String.fromCharCode(...buffer));
    }

    // ===== TEMPLATES =====
    const templates = {
      executive: { primary: '#0066cc', accent: '#00cc99', bg: '#fafcff', font: "'Merriweather', serif" },
      tech: { primary: '#0f172a', accent: '#38bdf8', bg: '#f1f5f9', font: "'IBM Plex Sans', monospace" },
      creative: { primary: '#be123c', accent: '#f43f5e', bg: '#fff9f9', font: "'Montserrat', sans-serif" },
      consultant: { primary: '#1e293b', accent: '#8b5cf6', bg: '#f8fafc', font: "'IBM Plex Sans', sans-serif" },
      hybrid: { primary: '#0d9488', accent: '#14b8a6', bg: '#f0fdfa', font: "'IBM Plex Sans', sans-serif" }
    };

    document.querySelectorAll('.template-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.template-card').forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        applyTemplate(card.dataset.template);
        updatePreview();
      });
    });

    function applyTemplate(name) {
      const t = templates[name] || templates.executive;
      document.documentElement.style.setProperty('--primary', t.primary);
      document.documentElement.style.setProperty('--accent', t.accent);
      document.documentElement.style.setProperty('--bg', t.bg);
      document.getElementById('template-styles').innerHTML = `
        :root {
          --primary: ${t.primary};
          --accent: ${t.accent};
          --bg: ${t.bg};
          --card-bg: white;
        }
        h1, h2, h3 { font-family: ${t.font} !important; }
      `;
    }

    // ===== ADDERS =====
    function addExperience() {
      const div = document.createElement('div');
      div.className = 'experience-item';
      div.innerHTML = `
        <button class="remove-btn" onclick="this.parentElement.remove(); updatePreview();">Ã—</button>
        <input type="text" placeholder="Job Title" class="exp-title" oninput="updatePreview()">
        <input type="text" placeholder="Company" class="exp-company" oninput="updatePreview()">
        <input type="text" placeholder="Dates" class="exp-dates" oninput="updatePreview()">
        <textarea placeholder="Impact: What problem did you solve? What was the result?" class="exp-desc" rows="3" oninput="updatePreview()"></textarea>
      `;
      document.getElementById('experience-list').appendChild(div);
    }

    function addEducation() {
      const div = document.createElement('div');
      div.className = 'education-item';
      div.innerHTML = `
        <button class="remove-btn" onclick="this.parentElement.remove(); updatePreview();">Ã—</button>
        <input type="text" placeholder="Degree" class="edu-degree" oninput="updatePreview()">
        <input type="text" placeholder="Institution" class="edu-inst" oninput="updatePreview()">
        <input type="text" placeholder="Year" class="edu-year" oninput="updatePreview()">
      `;
      document.getElementById('education-list').appendChild(div);
    }

    function addCert() {
      const div = document.createElement('div');
      div.className = 'cert-item';
      div.innerHTML = `
        <button class="remove-btn" onclick="this.parentElement.remove(); updatePreview();">Ã—</button>
        <input type="text" placeholder="Certification Name" class="cert-name" oninput="updatePreview()">
        <input type="text" placeholder="Issuer" class="cert-issuer" oninput="updatePreview()">
        <input type="text" placeholder="Date" class="cert-date" oninput="updatePreview()">
      `;
      document.getElementById('certs-list').appendChild(div);
    }

    function addShowcaseItem() {
      const div = document.createElement('div');
      div.className = 'showcase-item';
      div.innerHTML = `
        <button class="remove-btn" onclick="this.parentElement.remove(); updatePreview();">Ã—</button>
        <input type="text" placeholder="Project Title" class="showcase-title" oninput="updatePreview()">
        <textarea placeholder="Short description (1â€“2 sentences)" class="showcase-desc" rows="2" oninput="updatePreview()"></textarea>
      `;
      document.getElementById('showcase-list').appendChild(div);
    }

    // ===== PREVIEW =====
    async function updatePreview() {
      const name = document.getElementById('name').value || 'Your Name';
      const title = document.getElementById('title').value || 'Professional Title';
      const summary = document.getElementById('summary').value.replace(/\n/g, '<br>') || '';
      const skills = document.getElementById('skills').value.replace(/\n/g, '<br>') || '';
      const email = document.getElementById('email').value || '';
      const linkedin = document.getElementById('linkedin').value || '';
      const phone = document.getElementById('phone').value || '';

      let expHTML = '';
      document.querySelectorAll('.experience-item').forEach(item => {
        const t = item.querySelector('.exp-title')?.value;
        const c = item.querySelector('.exp-company')?.value;
        const d = item.querySelector('.exp-dates')?.value;
        const desc = item.querySelector('.exp-desc')?.value;
        if (t || c) {
          expHTML += `<div style="margin-bottom:1.2rem;"><strong>${t || 'Role'}</strong> â€” ${c || 'Company'}<br><em>${d || ''}</em><br>${desc || ''}</div>`;
        }
      });

      let eduHTML = '';
      document.querySelectorAll('.education-item').forEach(item => {
        const deg = item.querySelector('.edu-degree')?.value;
        const inst = item.querySelector('.edu-inst')?.value;
        const year = item.querySelector('.edu-year')?.value;
        if (deg) {
          eduHTML += `<p><strong>${deg}</strong><br>${inst || ''} ${year ? `(${year})` : ''}</p>`;
        }
      });

      let certHTML = '';
      document.querySelectorAll('.cert-item').forEach(item => {
        const name = item.querySelector('.cert-name')?.value;
        const issuer = item.querySelector('.cert-issuer')?.value;
        const date = item.querySelector('.cert-date')?.value;
        if (name) {
          certHTML += `<div style="margin-bottom:0.5rem;">${name}${issuer ? ` â€” ${issuer}` : ''}${date ? ` (${date})` : ''}</div>`;
        }
      });

      let showcaseHTML = '';
      document.querySelectorAll('.showcase-item').forEach(item => {
        const title = item.querySelector('.showcase-title')?.value || 'Project';
        const desc = item.querySelector('.showcase-desc')?.value || '';
        showcaseHTML += `<div style="margin-bottom:1.2rem; padding:1rem; background:#f8fafc; border-radius:8px;"><strong>${title}</strong><br>${desc}</div>`;
      });

      // Vault
      let vaultHTML = '';
      const vaultPass = document.getElementById('vault-password').value;
      const vaultContent = document.getElementById('vault-content').value;
      if (vaultContent && vaultPass) {
        const encrypted = await encryptVault(vaultContent, vaultPass);
        vaultHTML = `
          <div id="private-vault" style="margin-top:2rem; padding:1.5rem; background:#fff8e1; border-radius:12px; display:none;">
            <h3 style="color:#e65100;">Confidential Details</h3>
            <div id="vault-content-decrypted"></div>
          </div>
          <button id="unlock-vault" onclick="promptVaultPassword()" style="background:#e65100; color:white; border:none; padding:0.6rem 1.2rem; border-radius:30px; cursor:pointer; margin-top:1rem;">
            ðŸ”‘ View Private Details
          </button>
          <script>
            const encryptedData = "${encrypted}";
            async function promptVaultPassword() {
              const pass = prompt("Enter the guest password to view confidential details:");
              if (!pass) return;
              try {
                const encoder = new TextEncoder();
                const encrypted = new Uint8Array(atob(encryptedData).split('').map(c => c.charCodeAt(0)));
                const iv = encrypted.slice(0, 12);
                const data = encrypted.slice(12);
                const pwHash = await crypto.subtle.digest('SHA-256', encoder.encode(pass));
                const alg = { name: 'AES-GCM', iv: iv };
                const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']);
                const decrypted = await crypto.subtle.decrypt(alg, key, data);
                const text = new TextDecoder().decode(decrypted);
                document.getElementById('vault-content-decrypted').innerHTML = text.replace(/\\n/g, '<br>');
                document.getElementById('private-vault').style.display = 'block';
                document.getElementById('unlock-vault').style.display = 'none';
              } catch (e) {
                alert("Incorrect password. Access denied.");
              }
            }
          </script>
        `;
      }

      document.getElementById('preview').innerHTML = `
        <div style="text-align:center; margin-bottom:2rem;">
          <h1>${name}</h1>
          <p style="color:var(--primary); font-size:1.3rem;">${title}</p>
        </div>
        ${summary ? `<div style="margin-bottom:2rem;">${summary}</div>` : ''}
        ${skills ? `<div style="margin-bottom:2rem;"><h2 style="color:var(--primary);">Key Skills</h2><p>${skills}</p></div>` : ''}
        ${expHTML ? `<div style="margin-bottom:2rem;"><h2 style="color:var(--primary);">Professional Experience</h2>${expHTML}</div>` : ''}
        ${eduHTML ? `<div style="margin-bottom:2rem;"><h2 style="color:var(--primary);">Education</h2>${eduHTML}</div>` : ''}
        ${certHTML ? `<div style="margin-bottom:2rem;"><h2 style="color:var(--primary);">Certifications</h2>${certHTML}</div>` : ''}
        ${showcaseHTML ? `<div style="margin-bottom:2rem;"><h2 style="color:var(--primary);">Key Projects</h2>${showcaseHTML}</div>` : ''}
        ${vaultHTML}
        <div><h2 style="color:var(--primary);">Contact</h2>
          ${email ? `<p>Email: ${email}</p>` : ''}
          ${linkedin ? `<p><a href="${linkedin}" target="_blank" style="color:var(--primary);">LinkedIn</a></p>` : ''}
          ${phone ? `<p>Phone: ${phone}</p>` : ''}
        </div>
      `;
    }

    // ===== PUBLISH =====
    function initiatePayment() {
      const name = document.getElementById('name').value?.trim();
      const email = document.getElementById('email').value?.trim();
      if (!name || !email) return alert("Please enter your name and email.");

      if (!confirm("Publish your ResuMe for $2.99?\nTest card: 4242 4242 4242 4242")) return;

      const slug = name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
      const url = `https://resu.me/${slug}`;

      document.getElementById('live-url').textContent = url;
      new QRCode(document.getElementById('qr-code'), { text: url, width: 200, height: 200 });
      document.getElementById('output').style.display = 'block';
      document.getElementById('output').scrollIntoView({ behavior: 'smooth' });
    }

    // Init
    applyTemplate('executive');
    addExperience();
    addEducation();
    addCert();
    addShowcaseItem();
  </script>

</body>
</html>